<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dự án Projection - Mai The Duy</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- CSS được nhúng trực tiếp vào HTML -->
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #0d1117;
            color: #c9d1d9;
            margin: 0;
            padding: 2rem;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            border-bottom: 1px solid #30363d;
            padding-bottom: 2rem;
            margin-bottom: 2rem;
        }

        .repo-title {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            font-size: 1.25rem;
            margin-bottom: 1rem;
        }

        .repo-title svg {
            fill: #8b949e;
        }

        .repo-title a {
            color: #58a6ff;
            text-decoration: none;
            transition: text-decoration 0.2s;
        }
        .repo-title a:hover {
            text-decoration: underline;
        }

        h1 {
            font-size: 2.5rem;
            color: #f0f6fc;
            margin: 0.5rem 0;
        }

        .subtitle {
            font-size: 1.1rem;
            color: #8b949e;
        }

        code {
            background-color: #2c323a;
            padding: 3px 6px;
            border-radius: 5px;
            font-family: monospace;
        }

        .project-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .project-card {
            background-color: #161b22;
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 1.5rem;
            text-decoration: none;
            color: #c9d1d9;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out, border-color 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            font-weight: bold;
            text-align: center;
            min-height: 80px;
        }

        .project-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
            border-color: #8b949e;
        }

        .card-placeholder {
            background-color: #161b22;
            border: 1px solid #30363d;
            border-radius: 8px;
            min-height: 112px;
            animation: pulse 1.5s infinite ease-in-out;
        }
        
        #error-message {
            color: #f85149;
            background-color: rgba(248, 81, 73, 0.1);
            border: 1px solid rgba(248, 81, 73, 0.5);
            padding: 1rem;
            border-radius: 6px;
            text-align: center;
        }


        @keyframes pulse {
            0% { background-color: #161b22; }
            50% { background-color: #21262d; }
            100% { background-color: #161b22; }
        }

        footer {
            text-align: center;
            margin-top: 3rem;
            padding-top: 1.5rem;
            border-top: 1px solid #30363d;
            color: #8b949e;
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <div class="repo-title">
                <svg aria-hidden="true" height="24" viewBox="0 0 16 16" version="1.1" width="24" class="octicon octicon-repo">
                    <path d="M2 2.5A2.5 2.5 0 0 1 4.5 0h8.75a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h1.75v-2h-8a1 1 0 0 0-.71.29L2 11.71v-9.21A1 1 0 0 1 2.5 1.5H4a.75.75 0 0 1 0 1.5H2.5v9.21l1.22-1.22a2.5 2.5 0 0 1 1.77-.73h8.26v-2H7.5a.75.75 0 0 1 0-1.5h5.25v-2H4.5a1 1 0 0 0-1 1v1.51L2 8.71V2.5Z"></path>
                </svg>
                <a href="https://github.com/maitheduy/Projection" target="_blank">maitheduy / Projection</a>
            </div>
            <h1>Trang chủ các mô phỏng Phép chiếu</h1>
            <p class="subtitle">Danh sách các trang mô phỏng được tạo tự động từ thư mục <code>/data</code>.</p>
        </header>

        <main>
            <div id="project-list" class="project-grid">
                <!-- Placeholder cards for loading animation -->
                <div class="card-placeholder"></div>
                <div class="card-placeholder"></div>
                <div class="card-placeholder"></div>
                <div class="card-placeholder"></div>
                <div class="card-placeholder"></div>
                <div class="card-placeholder"></div>
            </div>
        </main>

        <footer>
            <p>© 2024 - Tự động triển khai qua GitHub Pages.</p>
        </footer>
    </div>

    <!-- JavaScript được nhúng trực tiếp vào HTML -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Cấu hình ---
            const owner = 'maitheduy';
            const repo = 'Projection';
            const dataPath = 'data'; // Thư mục chứa các file .html
            // -----------------

            const apiUrl = `https://api.github.com/repos/${owner}/${repo}/contents/${dataPath}`;
            const listContainer = document.getElementById('project-list');

            const fetchProjects = async () => {
                try {
                    const response = await fetch(apiUrl);
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(`API Error ${response.status}: ${errorData.message || 'Không thể lấy dữ liệu từ GitHub.'}`);
                    }
                    const files = await response.json();

                    const htmlFiles = files
                        .filter(file => file.type === 'file' && file.name.endsWith('.html'))
                        .sort((a, b) => a.name.localeCompare(b.name, undefined, { numeric: true, sensitivity: 'base' }));
                    
                    listContainer.innerHTML = ''; // Xóa placeholder

                    if (htmlFiles.length === 0) {
                        listContainer.innerHTML = `<p id="error-message">Không tìm thấy file <code>.html</code> nào trong thư mục <code>/${dataPath}</code>.</p>`;
                        return;
                    }

                    htmlFiles.forEach(file => {
                        const displayName = file.name
                            .replace(/\.html$/, '') // Xóa đuôi .html
                            .replace(/[_-]/g, ' ')  // Thay thế _ và - bằng khoảng trắng
                            .replace(/([a-z])([A-Z])/g, '$1 $2') // Thêm khoảng trắng giữa chữ thường và hoa
                            .replace(/(\d+)/g, ' $1') // Thêm khoảng trắng trước số
                            .replace(/\s+/g, ' ') // Xóa các khoảng trắng thừa
                            .trim();

                        const card = document.createElement('a');
                        card.className = 'project-card';
                        card.href = file.path;
                        card.textContent = displayName;
                        card.title = `Mở file: ${file.name}`;
                        listContainer.appendChild(card);
                    });

                } catch (error) {
                    console.error('Không thể tải danh sách dự án:', error);
                    listContainer.innerHTML = `<p id="error-message"><b>Đã xảy ra lỗi:</b> ${error.message}<br>Vui lòng kiểm tra lại cấu hình và chắc chắn thư mục <code>/${dataPath}</code> tồn tại.</p>`;
                }
            };

            fetchProjects();
        });
    </script>

</body>
</html>